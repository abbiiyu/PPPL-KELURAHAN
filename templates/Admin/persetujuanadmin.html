<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proses Persetujuan Cuti - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Gaya Kustom Umum (Konsisten dengan Dashboard) */
        body {
            background-color: #f7f9fb;
        }
        .header-bg {
            background-color: #3b4257;
            color: white;
        }
        .card-shadow {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        /* Custom colors matching the design */
        .color-blue { background-color: #4c8cd6; } 
        .color-green { background-color: #49c57d; } 
        .color-purple { background-color: #9c5aa8; }
        .progress-bar-red { height: 4px; background-color: #ef4444; }
        
        /* Gaya untuk Tabel */
        .riwayat-table th, .riwayat-table td {
            padding: 0.75rem 0.5rem;
            text-align: left;
            border-bottom: 1px solid #f0f2f7;
            font-size: 0.875rem; /* text-sm */
        }
        .riwayat-table th {
            background-color: #f7f9fb;
            font-weight: 600;
            color: #4a5568;
        }
        .action-btn {
            background-color: #4c8cd6; /* Blue-500 */
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            transition: background-color 0.2s;
        }
        .action-btn:hover {
             background-color: #3b76c5;
        }
        /* Style status */
        .status-menunggu { color: #f59e0b; font-weight: 600; } /* amber-500 */
    </style>
</head>
<body class="min-h-screen flex flex-col"> 
    
    <header class="header-bg p-4 flex items-center justify-between">
        <div class="flex items-center">
            <a href="homepage.html" class="mr-3 text-white text-lg hover:opacity-80">
                <i class="fas fa-arrow-left"></i>
            </a>
            <img src="../../logokelurahan.png" alt="Logo Kelurahan" class="w-8 h-8 mr-3 rounded-full object-cover">
            <h1 class="text-xl font-semibold">Kelurahan Lenteng Agung</h1>
        </div>
        <a href="adminpage.html" class="bg-blue-600 hover:bg-blue-700 text-white text-xs font-semibold py-1 px-3 rounded" role="button">Keluar</a>
    </header>

    <main class="p-4 pt-6 flex-grow">

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-8">
            <div class="color-blue card-shadow p-5 rounded-lg text-white w-full h-36 flex flex-col justify-between">
                <p class="text-xs font-semibold opacity-80">TOTAL PETUGAS</p>
                <div class="flex justify-between items-center">
                    <span class="text-4xl font-bold">43</span>
                    <i class="fas fa-users text-3xl opacity-50"></i>
                </div>
            </div>
            <div class="color-green card-shadow p-5 rounded-lg text-white w-full h-36 flex flex-col justify-between">
                <p class="text-xs font-semibold opacity-80">KEHADIRAN HARI INI</p>
                <div class="flex justify-between items-center">
                    <span class="text-4xl font-bold">37</span>
                    <i class="fas fa-times-circle text-3xl opacity-50"></i>
                </div>
                <div class="h-1 bg-white bg-opacity-30 rounded mt-3">
                    <div class="progress-bar-red rounded" style="width: 86%;"></div>
                </div>
            </div>
            <div class="color-purple card-shadow p-5 rounded-lg text-white w-full h-36 flex flex-col justify-between">
                <p class="text-xs font-semibold opacity-80">CUTI MENUNGGU PERSETUJUAN</p>
                <div class="flex justify-between items-center">
                    <span class="text-4xl font-bold" id="cutiMenungguCount">10</span>
                    <i class="fas fa-times-circle text-3xl opacity-50"></i>
                </div>
            </div>
        </div>
        
        <h1 class="text-2xl font-bold text-gray-800 mb-6 uppercase">PROSES PERSETUJUAN CUTI</h1>
        
        <div class="flex mb-4 space-x-3">
            <input 
                type="search" 
                id="search-input"
                placeholder="Cari (Nama, Tanggal, Jenis Cuti...)"
                class="flex-grow p-2 border border-gray-300 rounded-lg text-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50"
            />
            <button class="bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold py-2 px-4 rounded-lg">
                Filter
            </button>
        </div>

        <div class="bg-white card-shadow p-4 rounded-lg overflow-x-auto">
            <table class="w-full riwayat-table border-collapse">
                <thead>
                    <tr>
                        <th class="w-1/12">NO</th>
                        <th class="w-2/12">NAMA</th>
                        <th class="w-2/12">TANGGAL</th>
                        <th class="w-2/12">JENIS CUTI</th>
                        <th class="w-2/12">STATUS</th>
                        <th class="w-2/12">AKSI</th>
                    </tr>
                </thead>
                <tbody id="persetujuanCutiBody">
                    </tbody>
            </table>
            
            <div class="flex justify-end mt-4">
                <button class="bg-blue-600 hover:bg-gray-700 text-white text-sm font-semibold py-2 px-4 rounded-lg">
                    Export ke Excel
                </button>
            </div>
        </div>
    </main>

    <footer class="header-bg mt-8 p-4">
        <h2 class="text-lg font-semibold mb-4">Kantor Kelurahan Lenteng Agung</h2>
        <div class="space-y-3 text-sm text-gray-300">
            <p class="flex items-center">
                <i class="fas fa-map-marker-alt w-4 mr-3 text-gray-400"></i> JL. Lenteng Agung Raya No. 123
            </p>
            <p class="flex items-center">
                <i class="fas fa-phone w-4 mr-3 text-gray-400"></i> (021) 1234-5678
            </p>
            <p class="flex items-center">
                <i class="fas fa-envelope w-4 mr-3 text-gray-400"></i> info@lentengagung.go.id
            </p>
        </div>
        
        <h2 class="text-lg font-semibold mb-3 mt-6">Jam Operasional</h2>
        <div class="space-y-1 text-sm text-gray-300">
            <p>Senin - Jumat: <span class="font-semibold">08:00 - 17:00</span></p>
            <p>Sabtu: <span class="font-semibold">08:00 - 12:00</span></p>
            <p>Minggu: <span class="font-semibold">Tutup</span></p>
        </div>
        
        <div class="border-t-2 border-gray-600 my-6 w-full"></div> 

        <p class="text-center text-xs text-gray-400 w-full"> 
            Â© 2024 HRIS Lenteng Agung Village Office. Powered by<br>
            <span class="font-semibold">APTIKOM.</span>
        </p>
    </footer>

    <div id="persetujuanModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg w-full max-w-sm card-shadow">
            <h3 class="text-xl font-bold mb-4">Proses Cuti <span id="modalCutiId">#1</span></h3>
            <p class="text-sm mb-4">Anda akan memproses cuti yang diajukan oleh <span id="modalNama" class="font-semibold"></span>.</p>
            <p class="text-sm mb-6">Tanggal: <span id="modalTanggal" class="font-medium"></span> (<span id="modalJenis" class="font-medium"></span>)</p>

            <div class="flex justify-between space-x-3">
                <button onclick="prosesCuti('Disetujui')" class="flex-grow py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold">
                    <i class="fas fa-check"></i> Setujui
                </button>
                <button onclick="prosesCuti('Ditolak')" class="flex-grow py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold">
                    <i class="fas fa-times"></i> Tolak
                </button>
                <button onclick="tutupModal()" class="py-2 px-4 bg-gray-300 hover:bg-gray-400 rounded-lg font-semibold">
                    Batal
                </button>
            </div>
        </div>
    </div>


    <script>
        // [SIMULASI MOCK DATA] Ini adalah data yang seharusnya diambil dari backend
        let cutiData = [
            { id: 1, nama: "Mozaaa", tanggal: "17 Okt 2025", jenisCuti: "Sakit", status: "Menunggu" },
            { id: 2, nama: "Jeje", tanggal: "12 Okt 2025", jenisCuti: "Cuti Penting", status: "Menunggu" },
            { id: 3, nama: "Dodi", tanggal: "01 Okt 2025", jenisCuti: "Cuti Besar", status: "Menunggu" },
            { id: 4, nama: "Yanto", tanggal: "28 Nov 2025", jenisCuti: "Sakit", status: "Menunggu" },
            { id: 5, nama: "Azhar", tanggal: "21 Okt 2025", jenisCuti: "Cuti Penting", status: "Menunggu" },
            { id: 6, nama: "Bobi", tanggal: "26 Okt 2025", jenisCuti: "Cuti Penting", status: "Menunggu" },
            { id: 7, nama: "Krisna", tanggal: "04 Nov 2025", jenisCuti: "Cuti Penting", status: "Menunggu" },
            { id: 8, nama: "Yamal", tanggal: "09 Nov 2025", jenisCuti: "Cuti Besar", status: "Menunggu" },
            { id: 9, nama: "Kuncup", tanggal: "30 Okt 2025", jenisCuti: "Sakit", status: "Menunggu" },
            { id: 10, nama: "Ajis", tanggal: "11 Nov 2025", jenisCuti: "Cuti Penting", status: "Menunggu" },
        ];
        
        let cutiDipilih = null; // Menyimpan ID cuti yang sedang diproses

        /**
         * [Backend Dev: Hapus Logika Render Ini]
         * Mengisi tabel dengan data cuti yang menunggu persetujuan.
         */
        function renderTable() {
            const tbody = document.getElementById('persetujuanCutiBody');
            tbody.innerHTML = '';
            
            cutiData.forEach((item, index) => {
                const statusColor = item.status === 'Menunggu' ? 'text-yellow-600' : 
                                    item.status === 'Disetujui' ? 'text-green-600' : 'text-red-600';

                const row = `
                    <tr class="hover:bg-gray-50">
                        <td class="w-1/12">${item.id}</td>
                        <td class="w-2/12 font-semibold">${item.nama}</td>
                        <td class="w-2/12">${item.tanggal}</td>
                        <td class="w-2/12">${item.jenisCuti}</td>
                        <td class="w-2/12"><span class="${statusColor}">${item.status}</span></td>
                        <td class="w-2/12">
                            <button onclick="bukaModal(${item.id})" class="action-btn">Edit</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });

            // Update counter cuti menunggu
            const menungguCount = cutiData.filter(c => c.status === 'Menunggu').length;
            document.getElementById('cutiMenungguCount').textContent = menungguCount;
        }

        /**
         * Membuka Modal Persetujuan Cuti.
         * @param {number} id - ID cuti yang akan diproses.
         */
        function bukaModal(id) {
            cutiDipilih = cutiData.find(c => c.id === id);
            
            if (cutiDipilih) {
                document.getElementById('modalCutiId').textContent = `#${cutiDipilih.id}`;
                document.getElementById('modalNama').textContent = cutiDipilih.nama;
                document.getElementById('modalTanggal').textContent = cutiDipilih.tanggal;
                document.getElementById('modalJenis').textContent = cutiDipilih.jenisCuti;
                
                document.getElementById('persetujuanModal').style.display = 'flex';
            }
        }

        /**
         * Menutup Modal Persetujuan.
         */
        function tutupModal() {
            document.getElementById('persetujuanModal').style.display = 'none';
            cutiDipilih = null;
        }

        /**
         * [Backend Dev: Ganti Fungsi Ini dengan API PUT/POST]
         * Logika simulasi untuk menyetujui atau menolak cuti.
         * @param {string} status - 'Disetujui' atau 'Ditolak'.
         */
        function prosesCuti(status) {
            if (!cutiDipilih) return;
            
            // 1. [SIMULASI] Update data lokal
            const index = cutiData.findIndex(c => c.id === cutiDipilih.id);
            if (index !== -1) {
                cutiData[index].status = status; // Mengubah status cuti
                // [DALAM PRODUKSI]: Pada titik ini, data akan dikirim ke backend
                // dan backend akan mengupdate database dan mungkin memicu notifikasi ke user.
                
                // [SIMULASI] Setelah update, simpan ke Local Storage untuk demo
                // (Ini perlu disinkronkan dengan logika cuti user di file lain)
                // updateCutiStatusOnUserSide(cutiDipilih.id, status); 

                alert(`Cuti #${cutiDipilih.id} (${cutiDipilih.nama}) telah ${status}.`);
            }
            
            tutupModal();
            renderTable(); // Render ulang tabel untuk menampilkan status baru
        }
        
        // Fungsi ini akan dipanggil saat halaman dimuat
        document.addEventListener('DOMContentLoaded', renderTable);
    </script>
</body>
</html>